{
  "openapi": "3.0.3",
  "info": {
    "title": "safehaven",
    "description": "",
    "license": {
      "name": ""
    },
    "version": "0.1.0"
  },
  "paths": {
    "/api/admin/access_tokens": {
      "get": {
        "tags": [
          "admin::access_tokens"
        ],
        "operationId": "admin_access_tokens_list",
        "responses": {
          "200": {
            "description": "List of access tokens",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/AccessToken"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": [
          "admin::access_tokens"
        ],
        "operationId": "admin_access_token_new",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/NewOrUpdateAccessToken"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "List of access tokens",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AccessToken"
                }
              }
            }
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/admin/access_tokens/{id}": {
      "get": {
        "tags": [
          "admin::access_tokens"
        ],
        "operationId": "admin_access_token_get",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Access token identifier",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Access token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AccessToken"
                }
              }
            }
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": [
          "admin::access_tokens"
        ],
        "operationId": "admin_access_token_update",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Access token identifier",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/NewOrUpdateAccessToken"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Access token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AccessToken"
                }
              }
            }
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "admin::access_tokens"
        ],
        "operationId": "admin_access_token_delete",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Access token identifier",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Deletion successful"
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/admin/access_tokens/{id}/stats": {
      "get": {
        "tags": [
          "admin::access_tokens"
        ],
        "operationId": "admin_access_token_get_stats",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Access token identifier",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Access token statistics",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AccessTokenStats"
                }
              }
            }
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/admin/categories": {
      "get": {
        "tags": [
          "admin::categories"
        ],
        "operationId": "admin_categories_list",
        "responses": {
          "200": {
            "description": "List of categories",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Category"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": [
          "admin::categories"
        ],
        "operationId": "admin_category_new",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/NewOrUpdateCategory"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Category created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Category"
                }
              }
            }
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/admin/categories/:id/icon": {
      "put": {
        "tags": [
          "admin::categories"
        ],
        "operationId": "admin_category_update_icon",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Category identifier",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Icon"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Category icon updated"
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "admin::categories"
        ],
        "operationId": "admin_category_delete_icon",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Category identifier",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Category icon deletion successful"
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/admin/categories/{id}": {
      "get": {
        "tags": [
          "admin::categories"
        ],
        "operationId": "admin_category_get",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Category identifier",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Category details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Category"
                }
              }
            }
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": [
          "admin::categories"
        ],
        "operationId": "admin_category_update",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Category identifier",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/NewOrUpdateCategory"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Category updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Category"
                }
              }
            }
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "admin::categories"
        ],
        "operationId": "admin_category_delete",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Category identifier",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Category deletion successful"
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/admin/comments": {
      "post": {
        "tags": [
          "admin::comments"
        ],
        "operationId": "admin_comment_new",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AdminNewOrUpdateComment"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Comment created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AdminComment"
                }
              }
            }
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/admin/comments/pending": {
      "get": {
        "tags": [
          "admin::comments"
        ],
        "operationId": "admin_comments_pending",
        "responses": {
          "200": {
            "description": "List of pending comments",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/AdminListedComment"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/admin/comments/{id}": {
      "get": {
        "tags": [
          "admin::comments"
        ],
        "operationId": "admin_comment_get",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Comment identifier",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Comment details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AdminComment"
                }
              }
            }
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": [
          "admin::comments"
        ],
        "operationId": "admin_comment_update",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Comment identifier",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AdminNewOrUpdateComment"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Comment updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AdminComment"
                }
              }
            }
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "admin::comments"
        ],
        "operationId": "admin_comment_delete",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Comment identifier",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Comment deleted successfully"
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/admin/entities": {
      "post": {
        "tags": [
          "admin::entities"
        ],
        "operationId": "admin_entity_new",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AdminNewOrUpdateEntity"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Entity created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AdminEntity"
                }
              }
            }
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/admin/entities/pending": {
      "get": {
        "tags": [
          "admin::entities"
        ],
        "operationId": "admin_entities_pending",
        "responses": {
          "200": {
            "description": "List of pending entities",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/AdminListedEntity"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/admin/entities/search": {
      "post": {
        "tags": [
          "admin::entities"
        ],
        "operationId": "admin_entities_search",
        "parameters": [
          {
            "name": "page",
            "in": "query",
            "description": "Current page (default: 1)",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "page_size",
            "in": "query",
            "description": "Number of items per page (default: 20)",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AdminSearchRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Search results for entities",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AdminCachedEntitiesWithPagination"
                }
              }
            }
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/admin/entities/{id}": {
      "get": {
        "tags": [
          "admin::entities"
        ],
        "operationId": "admin_entity_get",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Entity identifier",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Entity details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AdminEntityWithRelations"
                }
              }
            }
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": [
          "admin::entities"
        ],
        "operationId": "admin_entity_update",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Entity identifier",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AdminNewOrUpdateEntity"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Entity updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AdminEntity"
                }
              }
            }
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "admin::entities"
        ],
        "operationId": "admin_entity_delete",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Entity identifier",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Entity deleted successfully"
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/admin/entities/{id}/comments": {
      "get": {
        "tags": [
          "admin::entities"
        ],
        "operationId": "admin_entity_get_comments",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Entity identifier",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of comments for the entity",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/AdminComment"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/admin/entities/{parent_id}/parent/{child_id}": {
      "post": {
        "tags": [
          "admin::entities"
        ],
        "operationId": "admin_entity_register_parent",
        "parameters": [
          {
            "name": "parent_id",
            "in": "path",
            "description": "Parent entity identifier",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "child_id",
            "in": "path",
            "description": "Child entity identifier",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Parent entity registered successfully"
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "admin::entities"
        ],
        "operationId": "admin_entity_remove_parent",
        "parameters": [
          {
            "name": "parent_id",
            "in": "path",
            "description": "Parent entity identifier",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "child_id",
            "in": "path",
            "description": "Child entity identifier",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Parent-child relationship removed successfully"
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Relationship not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/admin/families": {
      "get": {
        "tags": [
          "admin::families"
        ],
        "operationId": "admin_families_list",
        "responses": {
          "200": {
            "description": "List of families",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Family"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": [
          "admin::families"
        ],
        "operationId": "admin_family_new",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/NewOrUpdateFamily"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Family created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Family"
                }
              }
            }
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/admin/families/:id/icon": {
      "put": {
        "tags": [
          "admin::families"
        ],
        "operationId": "admin_family_update_icon",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Family identifier",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Icon"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Family icon updated"
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "admin::families"
        ],
        "operationId": "admin_family_delete_icon",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Family identifier",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Family icon deletion successful"
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/admin/families/{id}": {
      "get": {
        "tags": [
          "admin::families"
        ],
        "operationId": "admin_family_get",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Family identifier",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Family details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Family"
                }
              }
            }
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": [
          "admin::families"
        ],
        "operationId": "admin_family_update",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Family identifier",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/NewOrUpdateFamily"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Family updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Family"
                }
              }
            }
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "admin::families"
        ],
        "operationId": "admin_family_delete",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Family identifier",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Family deleted successfully"
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/admin/options": {
      "get": {
        "tags": [
          "admin::options"
        ],
        "operationId": "admin_options_get",
        "responses": {
          "200": {
            "description": "Option map",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SafeHavenOptions"
                }
              }
            }
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/admin/options/{name}": {
      "put": {
        "tags": [
          "admin::options"
        ],
        "operationId": "admin_options_update",
        "parameters": [
          {
            "name": "name",
            "in": "path",
            "description": "Option group name",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ConfigurationOption"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Option map",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SafeHavenOptions"
                }
              }
            }
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "admin::options"
        ],
        "operationId": "admin_options_delete",
        "parameters": [
          {
            "name": "name",
            "in": "path",
            "description": "Option group name",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Option map",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SafeHavenOptions"
                }
              }
            }
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/admin/session": {
      "get": {
        "tags": [
          "admin"
        ],
        "operationId": "admin_login_check",
        "responses": {
          "200": {
            "description": "Check login",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AdminUserIdentity"
                }
              }
            }
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": [
          "admin"
        ],
        "operationId": "admin_login",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/LoginRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Login and set cookies",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LoginResponse"
                }
              }
            }
          },
          "404": {
            "description": "User or password not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "admin"
        ],
        "operationId": "admin_logout",
        "responses": {
          "200": {
            "description": "Logout",
            "headers": {
              "Set-Cookie": {
                "schema": {
                  "$ref": "#/components/schemas/CookieJar"
                },
                "description": "Cookie jar cleaned"
              }
            }
          },
          "404": {
            "description": "User or password not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/admin/stats": {
      "get": {
        "tags": [
          "admin::statistics"
        ],
        "operationId": "admin_home_stats",
        "responses": {
          "200": {
            "description": "Stats for the home page",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HomePageStats"
                }
              }
            }
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/admin/stats/count-comments-entities": {
      "get": {
        "tags": [
          "admin::statistics"
        ],
        "operationId": "admin_count_comments_entities",
        "responses": {
          "200": {
            "description": "Dicts of entities and comments counts by family and category id",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Json"
                }
              }
            }
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/admin/tags": {
      "get": {
        "tags": [
          "admin::tags"
        ],
        "operationId": "admin_tags_list",
        "responses": {
          "200": {
            "description": "List of tags",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Tag"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": [
          "admin::tags"
        ],
        "operationId": "admin_tag_new",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/NewOrUpdateTag"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Tag created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Tag"
                }
              }
            }
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/admin/tags/{id}": {
      "get": {
        "tags": [
          "admin::tags"
        ],
        "operationId": "admin_tag_get",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Tag identifier",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Tag details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Tag"
                }
              }
            }
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": [
          "admin::tags"
        ],
        "operationId": "admin_tag_update",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Tag identifier",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/NewOrUpdateTag"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Tag updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Tag"
                }
              }
            }
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "admin::tags"
        ],
        "operationId": "admin_tag_delete",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Tag identifier",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Tag deleted successfully"
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/admin/users": {
      "get": {
        "tags": [
          "admin::users"
        ],
        "operationId": "admin_users_list",
        "responses": {
          "200": {
            "description": "List of users",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/User"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": [
          "admin::users"
        ],
        "operationId": "admin_user_new",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/NewUser"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "User",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/User"
                }
              }
            }
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/admin/users/self/password": {
      "put": {
        "tags": [
          "admin::users"
        ],
        "operationId": "admin_user_change_self_password",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/NewOrUpdatedUser"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "User",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/User"
                }
              }
            }
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/admin/users/{id}": {
      "get": {
        "tags": [
          "admin::users"
        ],
        "operationId": "admin_user_get",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "User identifier",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "User",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/User"
                }
              }
            }
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": [
          "admin::users"
        ],
        "operationId": "admin_user_update",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "User identifier",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/NewOrUpdatedUser"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "User",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/User"
                }
              }
            }
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "admin::users"
        ],
        "operationId": "admin_user_delete",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "User identifier",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Deletion successful"
          },
          "401": {
            "description": "Invalid permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/bootstrap/{token}": {
      "get": {
        "tags": [
          "root"
        ],
        "operationId": "bootstrap",
        "parameters": [
          {
            "name": "token",
            "in": "path",
            "description": "Access token",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "referrer",
            "in": "query",
            "description": "The referrer URL to register the visit",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Bootstraping data",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BootstrapResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/map/comments": {
      "post": {
        "tags": [
          "map"
        ],
        "operationId": "viewer_new_comment",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/NewCommentRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Comment",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PublicComment"
                }
              }
            }
          },
          "401": {
            "description": "Invalid token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/map/entities": {
      "post": {
        "tags": [
          "map"
        ],
        "operationId": "viewer_new_entity",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/PublicNewEntityRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Entity",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PublicNewEntityResponse"
                }
              }
            }
          },
          "401": {
            "description": "Invalid token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/map/entities/{id}": {
      "post": {
        "tags": [
          "map"
        ],
        "operationId": "viewer_fetch_entity",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "description": "",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/FetchEntityRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Entity",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/FetchedEntity"
                }
              }
            }
          },
          "401": {
            "description": "Invalid token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Entity not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/map/search": {
      "post": {
        "tags": [
          "map"
        ],
        "operationId": "viewer_search_request",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SearchRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "List of entities",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CachedEntitiesWithPagination"
                }
              }
            }
          },
          "401": {
            "description": "Invalid token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/map/view": {
      "post": {
        "tags": [
          "map"
        ],
        "operationId": "viewer_view_request",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ViewRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "List of entities",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EntitiesAndClusters"
                }
              }
            }
          },
          "401": {
            "description": "Invalid token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/status": {
      "get": {
        "tags": [
          "root"
        ],
        "operationId": "status",
        "responses": {
          "200": {
            "description": "Status check and pre init",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/StatusResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/version": {
      "get": {
        "tags": [
          "root"
        ],
        "operationId": "version",
        "responses": {}
      }
    }
  },
  "components": {
    "schemas": {
      "AccessToken": {
        "type": "object",
        "required": [
          "id",
          "title",
          "token",
          "permissions",
          "last_week_visits",
          "active"
        ],
        "properties": {
          "active": {
            "type": "boolean"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "last_week_visits": {
            "type": "integer",
            "format": "int64"
          },
          "permissions": {
            "$ref": "#/components/schemas/Json"
          },
          "title": {
            "type": "string"
          },
          "token": {
            "type": "string"
          }
        }
      },
      "AccessTokenStats": {
        "type": "object",
        "required": [
          "origins",
          "visits_30_days"
        ],
        "properties": {
          "origins": {
            "$ref": "#/components/schemas/Json"
          },
          "visits_30_days": {
            "$ref": "#/components/schemas/Json"
          }
        }
      },
      "AdminCachedEntity": {
        "type": "object",
        "required": [
          "id",
          "entity_id",
          "category_id",
          "tags_ids",
          "family_id",
          "display_name",
          "hidden"
        ],
        "properties": {
          "category_id": {
            "type": "string",
            "format": "uuid"
          },
          "display_name": {
            "type": "string"
          },
          "entity_id": {
            "type": "string",
            "format": "uuid"
          },
          "family_id": {
            "type": "string",
            "format": "uuid"
          },
          "hidden": {
            "type": "boolean"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "tags_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          }
        }
      },
      "AdminComment": {
        "type": "object",
        "required": [
          "id",
          "entity_id",
          "author",
          "text",
          "data",
          "created_at",
          "updated_at",
          "moderated",
          "version",
          "entity_display_name",
          "category_id"
        ],
        "properties": {
          "author": {
            "type": "string"
          },
          "category_id": {
            "type": "string",
            "format": "uuid"
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "data": {},
          "entity_display_name": {
            "type": "string"
          },
          "entity_id": {
            "type": "string",
            "format": "uuid"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "moderated": {
            "type": "boolean"
          },
          "text": {
            "type": "string"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          },
          "version": {
            "type": "integer",
            "format": "int32"
          }
        }
      },
      "AdminEntity": {
        "type": "object",
        "required": [
          "id",
          "display_name",
          "category_id",
          "family_id",
          "locations",
          "data",
          "tags",
          "hidden",
          "moderated",
          "version",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "category_id": {
            "type": "string",
            "format": "uuid"
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "data": {},
          "display_name": {
            "type": "string"
          },
          "family_id": {
            "type": "string",
            "format": "uuid"
          },
          "hidden": {
            "type": "boolean"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "locations": {
            "$ref": "#/components/schemas/Json"
          },
          "moderated": {
            "type": "boolean"
          },
          "moderation_notes": {
            "type": "string",
            "nullable": true
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          },
          "version": {
            "type": "integer",
            "format": "int32"
          }
        }
      },
      "AdminEntityWithRelations": {
        "type": "object",
        "required": [
          "id",
          "display_name",
          "category_id",
          "family_id",
          "locations",
          "data",
          "tags",
          "hidden",
          "moderated",
          "version",
          "created_at",
          "updated_at",
          "parents",
          "children"
        ],
        "properties": {
          "category_id": {
            "type": "string",
            "format": "uuid"
          },
          "children": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AdminListedEntity"
            }
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "data": {},
          "display_name": {
            "type": "string"
          },
          "family_id": {
            "type": "string",
            "format": "uuid"
          },
          "hidden": {
            "type": "boolean"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "locations": {
            "$ref": "#/components/schemas/sqlx.types.Json"
          },
          "moderated": {
            "type": "boolean"
          },
          "moderation_notes": {
            "type": "string",
            "nullable": true
          },
          "parents": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AdminListedEntity"
            }
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          },
          "version": {
            "type": "integer",
            "format": "int32"
          }
        }
      },
      "AdminListedComment": {
        "type": "object",
        "required": [
          "id",
          "entity_id",
          "author",
          "entity_display_name",
          "entity_category_id",
          "created_at",
          "updated_at",
          "moderated"
        ],
        "properties": {
          "author": {
            "type": "string"
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "entity_category_id": {
            "type": "string",
            "format": "uuid"
          },
          "entity_display_name": {
            "type": "string"
          },
          "entity_id": {
            "type": "string",
            "format": "uuid"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "moderated": {
            "type": "boolean"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "AdminListedEntity": {
        "type": "object",
        "required": [
          "id",
          "display_name",
          "category_id",
          "tags",
          "hidden",
          "moderated",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "category_id": {
            "type": "string",
            "format": "uuid"
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "display_name": {
            "type": "string"
          },
          "hidden": {
            "type": "boolean"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "moderated": {
            "type": "boolean"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "AdminNewOrUpdateComment": {
        "type": "object",
        "required": [
          "entity_id",
          "author",
          "text",
          "data",
          "moderated",
          "version"
        ],
        "properties": {
          "author": {
            "type": "string"
          },
          "data": {},
          "entity_id": {
            "type": "string",
            "format": "uuid"
          },
          "moderated": {
            "type": "boolean"
          },
          "text": {
            "type": "string"
          },
          "version": {
            "type": "integer",
            "format": "int32"
          }
        }
      },
      "AdminNewOrUpdateEntity": {
        "type": "object",
        "required": [
          "display_name",
          "category_id",
          "locations",
          "data",
          "tags",
          "hidden",
          "moderated"
        ],
        "properties": {
          "category_id": {
            "type": "string",
            "format": "uuid"
          },
          "data": {},
          "display_name": {
            "type": "string"
          },
          "hidden": {
            "type": "boolean"
          },
          "locations": {
            "$ref": "#/components/schemas/Json"
          },
          "moderated": {
            "type": "boolean"
          },
          "moderation_notes": {
            "type": "string",
            "nullable": true
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "version": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          }
        }
      },
      "AdminSearchRequest": {
        "type": "object",
        "required": [
          "family",
          "search",
          "active_categories_ids",
          "required_tags_ids",
          "excluded_tags_ids",
          "enums_constraints"
        ],
        "properties": {
          "active_categories_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "enums_constraints": {},
          "excluded_tags_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "family": {
            "type": "string",
            "format": "uuid"
          },
          "required_tags_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "search": {
            "type": "string"
          }
        }
      },
      "AdminUserIdentity": {
        "type": "object",
        "required": [
          "admin_id",
          "username",
          "is_admin"
        ],
        "properties": {
          "admin_id": {
            "type": "string",
            "format": "uuid"
          },
          "is_admin": {
            "type": "boolean"
          },
          "username": {
            "type": "string"
          }
        }
      },
      "BootstrapResponse": {
        "type": "object",
        "required": [
          "signed_token",
          "families",
          "categories",
          "allowed_categories",
          "allowed_tags",
          "can_list_entities",
          "can_list_without_query",
          "can_list_with_filters",
          "can_list_with_enum_constraints",
          "can_access_entity",
          "can_access_comments",
          "can_add_entity",
          "can_add_comment",
          "tags"
        ],
        "properties": {
          "allowed_categories": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            },
            "description": "List of allowed categories"
          },
          "allowed_tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            },
            "description": "List of allowed tags"
          },
          "can_access_comments": {
            "type": "boolean",
            "description": "Permission to view an entity's comments"
          },
          "can_access_entity": {
            "type": "boolean",
            "description": "Permission to view an entity"
          },
          "can_add_comment": {
            "type": "boolean",
            "description": "Permission to add a comment to an entity"
          },
          "can_add_entity": {
            "type": "boolean",
            "description": "Permission to add an entity"
          },
          "can_list_entities": {
            "type": "boolean",
            "description": "Permission to list entities"
          },
          "can_list_with_enum_constraints": {
            "type": "boolean",
            "description": "Permission to list entities with enum constraints"
          },
          "can_list_with_filters": {
            "type": "boolean",
            "description": "Permission to list entities with filters"
          },
          "can_list_without_query": {
            "type": "boolean",
            "description": "Permission to list entities with an empty or short query (can be used to list all entities)"
          },
          "categories": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Category"
            },
            "description": "List of known categories"
          },
          "families": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Family"
            },
            "description": "List of known families"
          },
          "signed_token": {
            "type": "string",
            "description": "Signed token for subsequent requests"
          },
          "tags": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Tag"
            },
            "description": "List of tags"
          }
        }
      },
      "CartographyClusterConfig": {
        "type": "object",
        "description": "Entity clusterization parameters",
        "properties": {
          "characteristic_distance": {
            "type": "number",
            "format": "double",
            "description": "Characteristic distance for clusterization",
            "default": 5.0
          },
          "declustering_speed": {
            "type": "number",
            "format": "double",
            "description": "Declustering speed (most of the time between 1.5 and 2, defaults to 1.65)",
            "default": 1.65
          },
          "minimal_cluster_size": {
            "type": "integer",
            "format": "int32",
            "description": "Minimal entity count for forming a cluster",
            "default": 6
          }
        }
      },
      "CartographyInitConfig": {
        "type": "object",
        "description": "Displayed map initialization parameters",
        "properties": {
          "center_lat": {
            "type": "number",
            "format": "double",
            "description": "Latitude of the map center (WGS84)",
            "default": 47.0
          },
          "center_lng": {
            "type": "number",
            "format": "double",
            "description": "Longitude of the map center (WGS84)",
            "default": 2.0
          },
          "zoom": {
            "type": "integer",
            "format": "int32",
            "description": "Zoom level of the map (from 2 to 20)",
            "default": 5,
            "minimum": 0
          }
        }
      },
      "CartographySourceConfig": {
        "type": "object",
        "properties": {
          "dark_map_attributions": {
            "type": "string",
            "description": "Dark mode map attributions",
            "default": "Map data  OpenStreetMap contributors"
          },
          "dark_map_url": {
            "type": "string",
            "description": "Dark mode map url",
            "default": "https://tile.openstreetmap.org/{z}/{x}/{y}.png"
          },
          "light_map_attributions": {
            "type": "string",
            "description": "Light mode map attributions",
            "default": "Map data  OpenStreetMap contributors"
          },
          "light_map_url": {
            "type": "string",
            "description": "Light mode map url",
            "default": "https://tile.openstreetmap.org/{z}/{x}/{y}.png"
          }
        }
      },
      "Category": {
        "type": "object",
        "required": [
          "id",
          "title",
          "family_id",
          "default_status",
          "fill_color",
          "border_color",
          "version"
        ],
        "properties": {
          "border_color": {
            "type": "string"
          },
          "default_status": {
            "type": "boolean"
          },
          "family_id": {
            "type": "string",
            "format": "uuid"
          },
          "fill_color": {
            "type": "string"
          },
          "icon_hash": {
            "type": "string",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "title": {
            "type": "string"
          },
          "version": {
            "type": "integer",
            "format": "int32"
          }
        }
      },
      "Cluster": {
        "type": "object",
        "required": [
          "id",
          "center_x",
          "center_y",
          "count"
        ],
        "properties": {
          "center_x": {
            "type": "number",
            "format": "double"
          },
          "center_y": {
            "type": "number",
            "format": "double"
          },
          "count": {
            "type": "integer",
            "format": "int32"
          },
          "id": {
            "type": "integer",
            "format": "int32",
            "minimum": 0
          }
        }
      },
      "ConfigurationOption": {
        "oneOf": [
          {
            "$ref": "#/components/schemas/GeneralOptions"
          },
          {
            "$ref": "#/components/schemas/InitPopupOptions"
          },
          {
            "$ref": "#/components/schemas/SafeModeConfig"
          },
          {
            "$ref": "#/components/schemas/CartographyInitConfig"
          },
          {
            "$ref": "#/components/schemas/CartographySourceConfig"
          },
          {
            "$ref": "#/components/schemas/CartographyClusterConfig"
          }
        ]
      },
      "EntitiesAndClusters": {
        "type": "object",
        "required": [
          "entities",
          "clusters"
        ],
        "properties": {
          "clusters": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Cluster"
            }
          },
          "entities": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ViewerCachedEntity"
            }
          }
        }
      },
      "ErrorResponse": {
        "type": "object",
        "required": [
          "error_code"
        ],
        "properties": {
          "details": {
            "type": "string",
            "nullable": true
          },
          "error_code": {
            "type": "string"
          }
        }
      },
      "Family": {
        "type": "object",
        "required": [
          "id",
          "title",
          "entity_form",
          "comment_form",
          "sort_order",
          "version"
        ],
        "properties": {
          "comment_form": {
            "$ref": "#/components/schemas/Json"
          },
          "entity_form": {
            "$ref": "#/components/schemas/Json"
          },
          "icon_hash": {
            "type": "string",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "sort_order": {
            "type": "integer",
            "format": "int32"
          },
          "title": {
            "type": "string"
          },
          "version": {
            "type": "integer",
            "format": "int32"
          }
        }
      },
      "FetchedEntity": {
        "type": "object",
        "required": [
          "entity",
          "comments",
          "parents",
          "children"
        ],
        "properties": {
          "children": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/PublicListedEntity"
            }
          },
          "comments": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/PublicComment"
            }
          },
          "entity": {
            "$ref": "#/components/schemas/PublicEntity"
          },
          "parents": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/PublicListedEntity"
            }
          }
        }
      },
      "Field": {
        "type": "object",
        "required": [
          "key",
          "display_name",
          "field_type",
          "indexed",
          "privately_indexed",
          "mandatory",
          "user_facing",
          "form_page",
          "form_weight",
          "display_weight"
        ],
        "properties": {
          "display_name": {
            "type": "string",
            "description": "The display name is used to show the field in the UI"
          },
          "display_weight": {
            "type": "integer",
            "format": "int32",
            "description": "The weight of the field in the display (when displayed, ordered by weight)",
            "minimum": 0
          },
          "field_type": {
            "$ref": "#/components/schemas/FieldType"
          },
          "field_type_metadata": {
            "description": "Used to store detail about the field that relevent\nonly for the frontend. For instance, if the field is an enum\nuse it to store possible values. If it is a SingleLineText, specify\nif it's an email, a phone number, etc...",
            "nullable": true
          },
          "form_page": {
            "type": "integer",
            "format": "int32",
            "description": "Form page number for the given field",
            "minimum": 0
          },
          "form_weight": {
            "type": "integer",
            "format": "int32",
            "description": "The weight of the field in the form (when displayed, ordered by weight)",
            "minimum": 0
          },
          "help": {
            "type": "string",
            "description": "The help text is used to show additional information about the field in the UI",
            "nullable": true
          },
          "indexed": {
            "type": "boolean",
            "description": "Sets if the field is indexed (used in full text search, or constraints search)"
          },
          "key": {
            "type": "string",
            "description": "The key is used to identify the field in the data object"
          },
          "mandatory": {
            "type": "boolean",
            "description": "Sets if the field is mandatory"
          },
          "privately_indexed": {
            "type": "boolean",
            "description": "Sets if the field is indexed, the field must be indexed for this setting to be used.\nPrivatly indexed means only administrators can constraint on this field.\nIt only works for EnumSingleOption and EnumMultiOption"
          },
          "user_facing": {
            "type": "boolean",
            "description": "Sets if the field is displayed to the final user"
          }
        }
      },
      "FieldType": {
        "type": "string",
        "enum": [
          "SingleLineText",
          "MultiLineText",
          "RichText",
          "Number",
          "Boolean",
          "DiscreteScore",
          "Date",
          "EnumSingleOption",
          "EnumMultiOption",
          "EventList"
        ]
      },
      "Form": {
        "type": "object",
        "required": [
          "title",
          "fields"
        ],
        "properties": {
          "fields": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Field"
            }
          },
          "help": {
            "type": "string",
            "description": "The help text is used to show additional information about the form in the UI",
            "nullable": true
          },
          "title": {
            "type": "string"
          }
        }
      },
      "GeneralOptions": {
        "type": "object",
        "properties": {
          "information": {
            "type": "string",
            "default": null,
            "nullable": true
          },
          "logo_url": {
            "type": "string",
            "default": null,
            "nullable": true
          },
          "redirect_url": {
            "type": "string",
            "default": null,
            "nullable": true
          },
          "subtitle": {
            "type": "string",
            "default": "Carte associative",
            "nullable": true
          },
          "title": {
            "type": "string",
            "default": "SafeHaven"
          }
        }
      },
      "HomePageStats": {
        "type": "object",
        "required": [
          "total_entities",
          "total_comments",
          "pending_entities",
          "pending_comments",
          "total_visits_30_days",
          "total_visits_7_days",
          "visits_30_days"
        ],
        "properties": {
          "pending_comments": {
            "type": "integer",
            "format": "int64"
          },
          "pending_entities": {
            "type": "integer",
            "format": "int64"
          },
          "total_comments": {
            "type": "integer",
            "format": "int64"
          },
          "total_entities": {
            "type": "integer",
            "format": "int64"
          },
          "total_visits_30_days": {
            "type": "integer",
            "format": "int64"
          },
          "total_visits_7_days": {
            "type": "integer",
            "format": "int64"
          },
          "visits_30_days": {
            "$ref": "#/components/schemas/Json"
          }
        }
      },
      "InitPopupOptions": {
        "type": "object",
        "properties": {
          "popup": {
            "type": "string",
            "default": null,
            "nullable": true
          },
          "popup_check_text": {
            "type": "string",
            "default": null,
            "nullable": true
          }
        }
      },
      "LocationRepresentation": {
        "type": "object",
        "required": [
          "x",
          "y",
          "plain_text"
        ],
        "properties": {
          "plain_text": {
            "type": "string"
          },
          "x": {
            "type": "number",
            "format": "double"
          },
          "y": {
            "type": "number",
            "format": "double"
          }
        }
      },
      "LoginRequest": {
        "type": "object",
        "required": [
          "username",
          "password",
          "remember_me"
        ],
        "properties": {
          "password": {
            "type": "string"
          },
          "remember_me": {
            "type": "boolean"
          },
          "username": {
            "type": "string"
          }
        }
      },
      "LoginResponse": {
        "type": "object",
        "required": [
          "is_admin"
        ],
        "properties": {
          "is_admin": {
            "type": "boolean"
          }
        }
      },
      "MultiPolygon": {
        "type": "array",
        "items": {
          "$ref": "#/components/schemas/Polygon"
        }
      },
      "NewCommentRequest": {
        "type": "object",
        "required": [
          "comment"
        ],
        "properties": {
          "comment": {
            "$ref": "#/components/schemas/PublicNewComment"
          },
          "hcaptcha_token": {
            "type": "string",
            "nullable": true
          }
        }
      },
      "NewOrUpdateAccessToken": {
        "type": "object",
        "required": [
          "title",
          "token",
          "permissions",
          "active"
        ],
        "properties": {
          "active": {
            "type": "boolean"
          },
          "permissions": {
            "$ref": "#/components/schemas/Json"
          },
          "title": {
            "type": "string"
          },
          "token": {
            "type": "string"
          }
        }
      },
      "NewOrUpdateCategory": {
        "type": "object",
        "required": [
          "title",
          "family_id",
          "default_status",
          "fill_color",
          "border_color"
        ],
        "properties": {
          "border_color": {
            "type": "string"
          },
          "default_status": {
            "type": "boolean"
          },
          "family_id": {
            "type": "string",
            "format": "uuid"
          },
          "fill_color": {
            "type": "string"
          },
          "title": {
            "type": "string"
          },
          "version": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          }
        }
      },
      "NewOrUpdateFamily": {
        "type": "object",
        "required": [
          "title",
          "entity_form",
          "comment_form",
          "sort_order"
        ],
        "properties": {
          "comment_form": {
            "$ref": "#/components/schemas/Form"
          },
          "entity_form": {
            "$ref": "#/components/schemas/Form"
          },
          "sort_order": {
            "type": "integer",
            "format": "int32"
          },
          "title": {
            "type": "string"
          },
          "version": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          }
        }
      },
      "NewOrUpdateTag": {
        "type": "object",
        "required": [
          "title",
          "is_filter",
          "is_primary_filter",
          "default_filter_status",
          "fill_color",
          "border_color"
        ],
        "properties": {
          "border_color": {
            "type": "string"
          },
          "default_filter_status": {
            "type": "boolean"
          },
          "fill_color": {
            "type": "string"
          },
          "filter_description": {
            "type": "string",
            "nullable": true
          },
          "is_filter": {
            "type": "boolean"
          },
          "is_primary_filter": {
            "type": "boolean"
          },
          "title": {
            "type": "string"
          },
          "version": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          }
        }
      },
      "NewOrUpdatedUser": {
        "type": "object",
        "required": [
          "name",
          "is_admin"
        ],
        "properties": {
          "is_admin": {
            "type": "boolean"
          },
          "name": {
            "type": "string"
          },
          "password": {
            "type": "string",
            "nullable": true
          }
        }
      },
      "PaginatedVec": {
        "type": "object",
        "required": [
          "entities",
          "total_results",
          "total_pages",
          "response_current_page"
        ],
        "properties": {
          "entities": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/T"
            }
          },
          "response_current_page": {
            "type": "integer",
            "format": "int64"
          },
          "total_pages": {
            "type": "integer",
            "format": "int64"
          },
          "total_results": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "ParentRepresentation": {
        "type": "object",
        "required": [
          "id",
          "display_name"
        ],
        "properties": {
          "display_name": {
            "type": "string"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "PermissionPolicy": {
        "type": "object",
        "required": [
          "allow_all",
          "allow_list",
          "force_exclude"
        ],
        "properties": {
          "allow_all": {
            "type": "boolean"
          },
          "allow_list": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "force_exclude": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          }
        }
      },
      "Permissions": {
        "type": "object",
        "required": [
          "families_policy",
          "categories_policy",
          "tags_policy",
          "can_list_entities",
          "can_list_without_query",
          "can_list_with_filters",
          "can_list_with_enum_constraints",
          "can_access_entity",
          "can_access_comments",
          "can_add_entity",
          "can_add_comment"
        ],
        "properties": {
          "can_access_comments": {
            "type": "boolean",
            "description": "Permission to view an entity's comments"
          },
          "can_access_entity": {
            "type": "boolean",
            "description": "Permission to view an entity"
          },
          "can_add_comment": {
            "type": "boolean",
            "description": "Permission to add a comment to an entity"
          },
          "can_add_entity": {
            "type": "boolean",
            "description": "Permission to add an entity"
          },
          "can_list_entities": {
            "type": "boolean",
            "description": "Permission to list entities"
          },
          "can_list_with_enum_constraints": {
            "type": "boolean",
            "description": "Permission to list entities with enum constraints"
          },
          "can_list_with_filters": {
            "type": "boolean",
            "description": "Permission to list entities with filters"
          },
          "can_list_without_query": {
            "type": "boolean",
            "description": "Permission to list entities with an empty or short query (can be used to list all entities)"
          },
          "categories_policy": {
            "$ref": "#/components/schemas/PermissionPolicy"
          },
          "families_policy": {
            "$ref": "#/components/schemas/PermissionPolicy"
          },
          "geographic_restrictions": {
            "allOf": [
              {
                "$ref": "#/components/schemas/MultiPolygon"
              }
            ],
            "nullable": true
          },
          "tags_policy": {
            "$ref": "#/components/schemas/PermissionPolicy"
          }
        }
      },
      "PublicComment": {
        "type": "object",
        "required": [
          "id",
          "author",
          "text",
          "data",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "author": {
            "type": "string"
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "data": {},
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "text": {
            "type": "string"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "PublicEntity": {
        "type": "object",
        "required": [
          "id",
          "display_name",
          "category_id",
          "family_id",
          "locations",
          "data",
          "tags",
          "entity_form",
          "comment_form",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "category_id": {
            "type": "string",
            "format": "uuid"
          },
          "comment_form": {
            "$ref": "#/components/schemas/Json"
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "data": {},
          "display_name": {
            "type": "string"
          },
          "entity_form": {
            "$ref": "#/components/schemas/Json"
          },
          "family_id": {
            "type": "string",
            "format": "uuid"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "locations": {
            "$ref": "#/components/schemas/Json"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "PublicListedEntity": {
        "type": "object",
        "required": [
          "id",
          "display_name",
          "category_id",
          "created_at",
          "tags"
        ],
        "properties": {
          "category_id": {
            "type": "string",
            "format": "uuid"
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "display_name": {
            "type": "string"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          }
        }
      },
      "PublicNewComment": {
        "type": "object",
        "required": [
          "entity_id",
          "author",
          "text",
          "data"
        ],
        "properties": {
          "author": {
            "type": "string"
          },
          "data": {},
          "entity_id": {
            "type": "string",
            "format": "uuid"
          },
          "text": {
            "type": "string"
          }
        }
      },
      "PublicNewEntity": {
        "type": "object",
        "required": [
          "display_name",
          "category_id",
          "locations",
          "data"
        ],
        "properties": {
          "category_id": {
            "type": "string",
            "format": "uuid"
          },
          "data": {},
          "display_name": {
            "type": "string"
          },
          "locations": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/UnprocessedLocation"
            }
          }
        }
      },
      "PublicNewEntityRequest": {
        "type": "object",
        "required": [
          "entity"
        ],
        "properties": {
          "comment": {
            "allOf": [
              {
                "$ref": "#/components/schemas/PublicNewComment"
              }
            ],
            "nullable": true
          },
          "entity": {
            "$ref": "#/components/schemas/PublicNewEntity"
          },
          "hcaptcha_token": {
            "type": "string",
            "nullable": true
          }
        }
      },
      "PublicNewEntityResponse": {
        "type": "object",
        "required": [
          "entity"
        ],
        "properties": {
          "comment": {
            "allOf": [
              {
                "$ref": "#/components/schemas/PublicComment"
              }
            ],
            "nullable": true
          },
          "entity": {
            "$ref": "#/components/schemas/PublicEntity"
          }
        }
      },
      "SafeHavenOptions": {
        "type": "object",
        "required": [
          "general",
          "init_popup",
          "safe_mode",
          "cartography_init",
          "cartography_source",
          "cartography_cluster"
        ],
        "properties": {
          "cartography_cluster": {
            "$ref": "#/components/schemas/CartographyClusterConfig"
          },
          "cartography_init": {
            "$ref": "#/components/schemas/CartographyInitConfig"
          },
          "cartography_source": {
            "$ref": "#/components/schemas/CartographySourceConfig"
          },
          "general": {
            "$ref": "#/components/schemas/GeneralOptions"
          },
          "init_popup": {
            "$ref": "#/components/schemas/InitPopupOptions"
          },
          "safe_mode": {
            "$ref": "#/components/schemas/SafeModeConfig"
          }
        }
      },
      "SafeHavenVersionResponse": {
        "type": "object",
        "required": [
          "version",
          "git_hash"
        ],
        "properties": {
          "git_hash": {
            "type": "string"
          },
          "github_latest_version": {
            "type": "string",
            "nullable": true
          },
          "version": {
            "type": "string"
          }
        }
      },
      "SafeMode": {
        "type": "object",
        "required": [
          "enabled",
          "hcaptcha_sitekey"
        ],
        "properties": {
          "enabled": {
            "type": "boolean"
          },
          "hcaptcha_sitekey": {
            "type": "string"
          }
        }
      },
      "SafeModeConfig": {
        "type": "object",
        "description": "Safe mode configuration, when enabled, the application will require hcaptcha validation for\nalmost every action making it harder to spam the application or dump the database content",
        "properties": {
          "enabled": {
            "type": "boolean",
            "description": "Enable safe mode",
            "default": false
          },
          "hcaptcha_secret": {
            "type": "string",
            "description": "Secret key for hcaptcha",
            "default": ""
          },
          "hcaptcha_sitekey": {
            "type": "string",
            "description": "Site key for hcaptcha",
            "default": ""
          }
        }
      },
      "SearchRequest": {
        "type": "object",
        "required": [
          "search_query",
          "family_id",
          "page",
          "page_size",
          "active_categories",
          "active_required_tags",
          "active_hidden_tags",
          "require_locations",
          "enums_constraints"
        ],
        "properties": {
          "active_categories": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "active_hidden_tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "active_required_tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "enums_constraints": {
            "type": "object",
            "additionalProperties": {
              "type": "array",
              "items": {}
            }
          },
          "family_id": {
            "type": "string",
            "format": "uuid"
          },
          "page": {
            "type": "integer",
            "format": "int64"
          },
          "page_size": {
            "type": "integer",
            "format": "int64"
          },
          "require_locations": {
            "type": "boolean"
          },
          "search_query": {
            "type": "string"
          }
        }
      },
      "StatusResponse": {
        "type": "object",
        "required": [
          "status",
          "general",
          "init_popup",
          "cartography_init",
          "cartography_source",
          "safe_mode"
        ],
        "properties": {
          "cartography_init": {
            "$ref": "#/components/schemas/CartographyInitConfig"
          },
          "cartography_source": {
            "$ref": "#/components/schemas/CartographySourceConfig"
          },
          "general": {
            "$ref": "#/components/schemas/GeneralOptions"
          },
          "init_popup": {
            "$ref": "#/components/schemas/InitPopupOptions"
          },
          "safe_mode": {
            "$ref": "#/components/schemas/SafeMode"
          },
          "status": {
            "type": "string"
          }
        }
      },
      "Tag": {
        "type": "object",
        "required": [
          "id",
          "title",
          "is_filter",
          "is_primary_filter",
          "default_filter_status",
          "fill_color",
          "border_color",
          "version"
        ],
        "properties": {
          "border_color": {
            "type": "string"
          },
          "default_filter_status": {
            "type": "boolean"
          },
          "fill_color": {
            "type": "string"
          },
          "filter_description": {
            "type": "string",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "is_filter": {
            "type": "boolean"
          },
          "is_primary_filter": {
            "type": "boolean"
          },
          "title": {
            "type": "string"
          },
          "version": {
            "type": "integer",
            "format": "int32"
          }
        }
      },
      "UnprocessedLocation": {
        "type": "object",
        "required": [
          "plain_text",
          "lat",
          "long"
        ],
        "properties": {
          "lat": {
            "type": "number",
            "format": "double"
          },
          "long": {
            "type": "number",
            "format": "double"
          },
          "plain_text": {
            "type": "string"
          }
        }
      },
      "User": {
        "type": "object",
        "required": [
          "id",
          "name",
          "is_admin"
        ],
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "is_admin": {
            "type": "boolean"
          },
          "last_login": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "name": {
            "type": "string"
          }
        }
      },
      "ViewRequest": {
        "type": "object",
        "required": [
          "family_id",
          "xmin",
          "ymin",
          "xmax",
          "ymax",
          "zoom_level",
          "active_categories",
          "active_required_tags",
          "active_hidden_tags",
          "enums_constraints"
        ],
        "properties": {
          "active_categories": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "active_hidden_tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "active_required_tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "enums_constraints": {
            "type": "object",
            "additionalProperties": {
              "type": "array",
              "items": {}
            }
          },
          "family_id": {
            "type": "string",
            "format": "uuid"
          },
          "xmax": {
            "type": "number",
            "format": "double"
          },
          "xmin": {
            "type": "number",
            "format": "double"
          },
          "ymax": {
            "type": "number",
            "format": "double"
          },
          "ymin": {
            "type": "number",
            "format": "double"
          },
          "zoom_level": {
            "type": "integer",
            "format": "int32",
            "minimum": 0
          }
        }
      },
      "ViewerCachedEntity": {
        "type": "object",
        "required": [
          "id",
          "entity_id",
          "category_id",
          "family_id",
          "display_name"
        ],
        "properties": {
          "category_id": {
            "type": "string",
            "format": "uuid"
          },
          "display_name": {
            "type": "string"
          },
          "entity_id": {
            "type": "string",
            "format": "uuid"
          },
          "family_id": {
            "type": "string",
            "format": "uuid"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "parent_display_name": {
            "type": "string",
            "nullable": true
          },
          "parent_id": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          },
          "plain_text_location": {
            "type": "string",
            "nullable": true
          },
          "web_mercator_x": {
            "type": "number",
            "format": "double",
            "nullable": true
          },
          "web_mercator_y": {
            "type": "number",
            "format": "double",
            "nullable": true
          }
        }
      },
      "ViewerSearchedCachedEntity": {
        "type": "object",
        "required": [
          "id",
          "entity_id",
          "category_id",
          "family_id",
          "display_name",
          "parents",
          "locations"
        ],
        "properties": {
          "category_id": {
            "type": "string",
            "format": "uuid"
          },
          "display_name": {
            "type": "string"
          },
          "entity_id": {
            "type": "string",
            "format": "uuid"
          },
          "family_id": {
            "type": "string",
            "format": "uuid"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "locations": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/LocationRepresentation"
            }
          },
          "parents": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ParentRepresentation"
            }
          }
        }
      }
    }
  }
}